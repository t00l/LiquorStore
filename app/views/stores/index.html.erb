  <p id="notice"><%= notice %></p>

  <div id="demo">
  </div>

  <div class="map_container">
    <div id="geolocation" class="geolocation"></div>
  </div>

  <br>

  <script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>

  <script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

  <script>
  var handler = Gmaps.build('Google');

  handler.buildMap({ internal: {id: 'geolocation'} }, function(){
    marker = handler.addMarkers(<%=raw @hash.to_json %>);
    if(navigator.geolocation)
      navigator.geolocation.getCurrentPosition(displayOnMap);
    else
      navigator.geolocation.getCurrentPosition(displayOnMapError);

  });

  function displayOnMap(position){
    
    marker2 = handler.addMarker({

      lat: position.coords.latitude,
      lng: position.coords.longitude,

      picture: {
          url: "<%= image_url('cat.png') %>",
          width:  36,
          height: 36
          },
      infowindow:  "aaa"
    });
    handler.map.centerOn(marker2);
    handler.getMap().setZoom(17);
  };

  function displayOnMapError(position){
    
    marker2 = handler.addMarker({

      lat: -33.469120,
      lng: -70.641997,

      picture: {
          url: "<%= image_url('cat.png') %>",
          width:  36,
          height: 36
          }
    });
    handler.map.centerOn(marker2);
    handler.getMap().setZoom(15);
  };

  </script>
